(function(e){function t(t){for(var n,r,s=t[0],l=t[1],c=t[2],u=0,f=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(f.length)f.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={app:0},o=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),i=a.n(n);i.a},"213a":function(e,t,a){"use strict";var n=a("5d3e"),i=a.n(n);i.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Index")],1)},o=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("label",{staticClass:"mainTitle"},[e._v("罩哪裡去"),n("i",{staticClass:"el-icon-info el-icon--right"}),n("div",{staticStyle:{"text-align":"center"},attrs:{id:"maskInfoImg"}},[n("img",{staticStyle:{width:"50%","object-fit":"contain"},attrs:{src:a("a14d")}})])])]),n("el-main",[[n("div",{staticClass:"hidden-sm-and-down"},[n("el-row",{attrs:{gutter:10,type:"flex"}},[n("el-col",{attrs:{span:6}},[n("el-input",{attrs:{placeholder:"請輸入藥局名稱","prefix-icon":"el-icon-search"},model:{value:e.filter.Name,callback:function(t){e.$set(e.filter,"Name",t)},expression:"filter.Name"}})],1),n("el-col",{attrs:{span:6}},[n("el-input",{attrs:{placeholder:"請選擇地點","prefix-icon":"el-icon-search",disabled:e.isUseCurrentLocationQuery},model:{value:e.filter.Area,callback:function(t){e.$set(e.filter,"Area",t)},expression:"filter.Area"}},[n("template",{slot:"append"},[n("el-button",{staticClass:"el-icon-map-location",on:{click:e.useCurrentLocation}})],1)],2)],1),n("el-col",{attrs:{span:3}},[n("el-checkbox",{attrs:{label:"成人口罩",border:""},model:{value:e.filter.HaveAdultMask,callback:function(t){e.$set(e.filter,"HaveAdultMask",t)},expression:"filter.HaveAdultMask"}})],1),n("el-col",{attrs:{span:3}},[n("el-checkbox",{attrs:{label:"兒童口罩",border:""},model:{value:e.filter.HaveChildMask,callback:function(t){e.$set(e.filter,"HaveChildMask",t)},expression:"filter.HaveChildMask"}})],1)],1)],1),n("div",{staticClass:"hidden-sm-and-up"},[n("el-row",[n("el-col",{attrs:{span:24}},[n("el-input",{attrs:{placeholder:"請輸入藥局名稱","prefix-icon":"el-icon-search"},model:{value:e.filter.Name,callback:function(t){e.$set(e.filter,"Name",t)},expression:"filter.Name"}})],1)],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-input",{attrs:{placeholder:"請選擇地點","prefix-icon":"el-icon-search",disabled:e.isUseCurrentLocationQuery},model:{value:e.filter.Area,callback:function(t){e.$set(e.filter,"Area",t)},expression:"filter.Area"}},[n("template",{slot:"append"},[n("el-button",{staticClass:"el-icon-map-location",on:{click:e.useCurrentLocation}})],1)],2)],1)],1),n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{span:10}},[n("el-checkbox",{attrs:{label:"成人口罩",border:""},model:{value:e.filter.HaveAdultMask,callback:function(t){e.$set(e.filter,"HaveAdultMask",t)},expression:"filter.HaveAdultMask"}})],1),n("el-col",{attrs:{span:10}},[n("el-checkbox",{attrs:{label:"兒童口罩",border:""},model:{value:e.filter.HaveChildMask,callback:function(t){e.$set(e.filter,"HaveChildMask",t)},expression:"filter.HaveChildMask"}})],1)],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-button",{attrs:{disabled:e.isLoading,type:"primary",icon:"el-icon-search",round:""},on:{click:e.query}},[e._v(" 查詢 ")])],1)],n("el-divider"),n("div",{staticStyle:{"text-align":"left"}},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.isUseCurrentLocationQuery,expression:"isUseCurrentLocationQuery"}]},[e._v("顯示距離當前位置"+e._s(e.distanceKM)+"公里藥局")])]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"},{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.showmore,expression:"showmore"}],attrs:{"infinite-scroll-disabled":"disabledLoadingMoreData"}},e._l(e.listDataSource,(function(t,a){return n("InfoCard",{key:a,attrs:{"current-location":e.currentLocation,info:t}})})),1),n("el-backtop",{attrs:{target:".el-main"}})],2)],1)},s=[],l=(a("99af"),a("4de4"),a("caad"),a("fb6a"),a("b0c0"),a("d3b7"),a("2532"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card",attrs:{shadow:"hover","body-style":{padding:"10px"}}},[a("div",{staticClass:"clearfix box-card-content hidden-sm-and-down"},[a("span",{staticStyle:{"font-size":"xx-large"}},[e._v(e._s(e.bindingData.name))]),a("i",{directives:[{name:"show",rawName:"v-show",value:e.moringOpen,expression:"moringOpen"}],staticClass:"el-icon-sunrise",staticStyle:{"font-size":"x-large"}}),a("i",{directives:[{name:"show",rawName:"v-show",value:e.afternoonOpen,expression:"afternoonOpen"}],staticClass:"el-icon-sunny",staticStyle:{"font-size":"x-large"}}),a("i",{directives:[{name:"show",rawName:"v-show",value:e.nightOpen,expression:"nightOpen"}],staticClass:"el-icon-moon",staticStyle:{"font-size":"x-large"}}),a("div",{staticStyle:{float:"right",padding:"10px 0"}},[a("el-badge",{staticStyle:{"margin-right":"25px"},attrs:{value:e.bindingData.mask_adult,max:999,type:e.maskCountAlert(e.bindingData.mask_adult)}},[a("el-tag",{attrs:{type:e.maskCountAlert(e.bindingData.mask_adult)}},[e._v(" 成人口罩 ")])],1),a("el-badge",{staticStyle:{"margin-right":"15px"},attrs:{value:e.bindingData.mask_child,max:999,type:e.maskCountAlert(e.bindingData.mask_child)}},[a("el-tag",{attrs:{type:e.maskCountAlert(e.bindingData.mask_child)}},[e._v(" 兒童口罩 ")])],1)],1),a("el-divider"),a("div",{staticClass:"simpleInfo"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("el-link",{attrs:{href:e.mapUrl,target:"_blank"}},[a("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.address)+" ")])],1),a("el-col",{staticStyle:{"text-align":"end"},attrs:{span:8}},[a("i",{staticClass:"el-icon-phone-outline"}),e._v(" "+e._s(e.bindingData.phone)+" ")])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v(" "+e._s(e.bindingData.note)+" ")])],1)],1)],1),a("div",{staticClass:"clearfix box-card-content hidden-sm-and-up"},[a("span",{staticStyle:{"font-size":"xx-large"}},[e._v(e._s(e.bindingData.name))]),a("i",{directives:[{name:"show",rawName:"v-show",value:e.moringOpen,expression:"moringOpen"}],staticClass:"el-icon-sunrise",staticStyle:{"font-size":"x-large"}}),a("i",{directives:[{name:"show",rawName:"v-show",value:e.afternoonOpen,expression:"afternoonOpen"}],staticClass:"el-icon-sunny",staticStyle:{"font-size":"x-large"}}),a("i",{directives:[{name:"show",rawName:"v-show",value:e.nightOpen,expression:"nightOpen"}],staticClass:"el-icon-moon",staticStyle:{"font-size":"x-large"}}),a("div",{staticStyle:{margin:"5px 0px"}},[a("el-badge",{staticStyle:{"margin-right":"30px"},attrs:{value:e.bindingData.mask_adult,max:999,type:e.maskCountAlert(e.bindingData.mask_adult)}},[a("el-tag",{attrs:{type:e.maskCountAlert(e.bindingData.mask_adult)}},[e._v(" 成人口罩 ")])],1),a("el-badge",{staticStyle:{"margin-right":"30px"},attrs:{value:e.bindingData.mask_child,max:999,type:e.maskCountAlert(e.bindingData.mask_child)}},[a("el-tag",{attrs:{type:e.maskCountAlert(e.bindingData.mask_child)}},[e._v(" 兒童口罩 ")])],1)],1),a("el-divider"),a("div",{staticClass:"simpleInfo"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-link",{attrs:{href:e.mapUrl,target:"_blank"}},[a("i",{staticClass:"el-icon-location-outline"}),e._v(" "+e._s(e.address)+" ")])],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("i",{staticClass:"el-icon-phone-outline"}),e._v(e._s(e.bindingData.phone)+" ")])],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("i",{staticClass:"el-icon-edit-outline"}),e._v(" "+e._s(e.bindingData.note)+" ")])],1)],1)],1)])}),c=[],d={name:"InfoCard",props:{info:{type:Object,default:function(){return{}},required:!0},currentLocation:{type:Object,default:function(){return{}},required:!1}},data:function(){return{bindingData:{name:"",phone:"",address:"",mask_adult:0,mask_child:0,updated:"",available:"",note:"",custom_note:"",website:"",county:"",town:"",cunli:"",service_periods:""},coordinates:[],todayServicePeriods:"NNN",location:null}},computed:{mapUrl:function(){var e="";return e=null==this.coordinates||2!=this.coordinates.length?"https://www.google.com/maps":null!=this.location&&null!=this.location.lat&&null!=this.location.lng?"https://maps.google.com/maps?saddr=".concat(this.location.lat,",").concat(this.location.lng,"&daddr=").concat(this.coordinates[1],",").concat(this.coordinates[0]):"http://maps.google.com/maps?q=".concat(this.bindingData.name,"@").concat(this.coordinates[1],",").concat(this.coordinates[0]),e},address:function(){return void 0!==this.info.distance?"".concat(this.bindingData.address," (").concat(Math.round(this.info.distance/1e3*100)/100," km)"):this.bindingData.address},moringOpen:function(){return 3===this.todayServicePeriods.length&&"N"===this.todayServicePeriods[0]},afternoonOpen:function(){return 3===this.todayServicePeriods.length&&"N"===this.todayServicePeriods[1]},nightOpen:function(){return 3===this.todayServicePeriods.length&&"N"===this.todayServicePeriods[2]}},watch:{info:{handler:function(e,t){if(e!==t){this.bindingData=e.properties,this.coordinates=e.geometry.coordinates;var a=0===(new Date).getDay()?7:(new Date).getDay();this.todayServicePeriods=this.bindingData.service_periods.substring(3*(a-1),3*a)}},immediate:!0,deep:!0},currentLocation:{handler:function(e,t){e!==t&&(this.location=e)},immediate:!0,deep:!0}},methods:{maskCountAlert:function(e){var t="";return t=e>100?"success":e>50?"warning":e>0?"danger":"info",t}}},u=d,f=(a("213a"),a("2877")),p=Object(f["a"])(u,l,c,!1,null,"1b0f08f2",null),h=p.exports,g={toRad:function(e){return e*Math.PI/180},getDisance:function(e,t){var a=0,n=this.toRad(e.lat),i=this.toRad(t.lat),o=n-i,r=this.toRad(e.lng)-this.toRad(t.lng);return a=2*Math.asin(Math.sqrt(Math.pow(Math.sin(o/2),2)+Math.cos(n)*Math.cos(i)*Math.pow(Math.sin(r/2),2))),6378137*a}},m=g,v=a("bc3a"),b={name:"Index",components:{InfoCard:h},data:function(){return{filter:{Name:"",Area:"",HaveAdultMask:!1,HaveChildMask:!1,IsOpen:!1,PageIndex:1,PageSize:10},currentLocation:null,isAreaLoading:!1,dataSource:[],listDataSource:[],isLoading:!1,isUseCurrentLocationQuery:!1,nearestCount:10,distanceKM:3,dialogVisible:!1}},computed:{totalCount:function(){return this.dataSource.length},diaplayDataCount:function(){return this.filter.PageIndex*this.filter.PageSize},noMoreData:function(){return this.diaplayDataCount>=this.totalCount},disabledLoadingMoreData:function(){return this.noMoreData||this.isLoading}},watch:{isUseCurrentLocationQuery:function(e){this.filter.Area=e?"目前所在位置":""}},mounted:function(){this.init()},methods:{init:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e.currentLocation={lat:t.coords.latitude,lng:t.coords.longitude},e.isUseCurrentLocationQuery=!0,e.query()}),(function(e){console.log(e)})):console.log("google location error")},reset:function(){this.filter.PageIndex=1,this.listDataSource=[]},query:function(){this.reset();var e=this;e.isLoading=!0,v.get("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json").then((function(t){e.dataSource=e.filterData(t.data.features),e.dataBind()})).catch((function(e){console.log(e)})).finally((function(){e.isLoading=!1}))},filterData:function(e){var t=this,a=e.filter((function(e){var a=e.properties,n=!0;if(t.isUseCurrentLocationQuery){var i=m.getDisance(t.currentLocation,{lat:e.geometry.coordinates[1],lng:e.geometry.coordinates[0]});n=i<=1e3*t.distanceKM,e.distance=i}else n=""===t.filter.Area||a.address.includes(t.filter.Area);return n&&(""===t.filter.Name||a.name.includes(t.filter.Name))&&(!t.filter.HaveAdultMask||a.mask_adult>0)&&(!t.filter.HaveChildMask||a.mask_child>0)}));return t.isUseCurrentLocationQuery&&(a=a.sort((function(e,t){return e.distance-t.distance}))),a},dataBind:function(){var e=(this.filter.PageIndex-1)*this.filter.PageSize,t=this.filter.PageIndex*this.filter.PageSize,a=this.dataSource.slice(e,t);this.listDataSource=this.listDataSource.concat(a)},showmore:function(){this.disabledLoadingMoreData||(this.filter.PageIndex++,this.dataBind())},useCurrentLocation:function(){this.isUseCurrentLocationQuery=!this.isUseCurrentLocationQuery},showMaskInfo:function(){this.dialogVisible=!0}}},y=b,k=(a("9223"),Object(f["a"])(y,r,s,!1,null,"6c195353",null)),x=k.exports,w={name:"App",components:{Index:x},created:function(){window.addEventListener("beforeinstallprompt",(function(e){console.log("beforeinstallprompt",e)}))}},C=w,_=(a("034f"),Object(f["a"])(C,i,o,!1,null,null,null)),S=_.exports,D=a("5c96"),M=a.n(D),O=(a("0fae"),a("bc3a")),A=a.n(O),L=a("ebfd"),N=a.n(L),P=(a("e05f"),a("9483"));Object(P["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var I=a("fb82");n["default"].config.productionTip=!1,n["default"].use(M.a),n["default"].use(A.a),n["default"].use(N.a),n["default"].use(I["a"]),new n["default"]({render:function(e){return e(S)}}).$mount("#app")},"5d3e":function(e,t,a){},8275:function(e,t,a){},"85ec":function(e,t,a){},9223:function(e,t,a){"use strict";var n=a("8275"),i=a.n(n);i.a},a14d:function(e,t,a){e.exports=a.p+"img/MaskInfo.c4b1bf23.png"}});
//# sourceMappingURL=app.fbd5cb9d.js.map